{
  "pluginAlias": "AHOY-DTU",
  "pluginType": "platform",
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "Platform Name",
        "type": "string",
        "required": true,
        "default": "AHOY-DTU Solar",
        "description": "Name of the AHOY-DTU platform in Homebridge"
      },
      "uiLanguage": {
        "title": "UI Language",
        "type": "string",
        "required": false,
        "default": "de",
        "enum": [
          "de",
          "en",
          "fr",
          "it",
          "zh"
        ],
        "enumNames": [
          "🇩🇪 Deutsch",
          "🇺🇸 English",
          "🇫🇷 Français",
          "🇮🇹 Italiano",
          "🇨🇳 中文"
        ],
        "description": "Language for the Homebridge UI interface"
      },
      "mqttHost": {
        "title": "MQTT Host",
        "type": "string",
        "required": true,
        "format": "ipv4",
        "description": "IP address of your MQTT broker (e.g., 192.168.1.100)"
      },
      "mqttPort": {
        "title": "MQTT Port",
        "type": "integer",
        "required": false,
        "default": 1883,
        "minimum": 1,
        "maximum": 65535,
        "description": "Port of your MQTT broker"
      },
      "mqttUsername": {
        "title": "MQTT Username",
        "type": "string",
        "required": false,
        "description": "Username for MQTT authentication (if required)"
      },
      "mqttPassword": {
        "title": "MQTT Password",
        "type": "string",
        "required": false,
        "format": "password",
        "description": "Password for MQTT authentication (if required)"
      },
      "mqttTopic": {
        "title": "MQTT Base Topic",
        "type": "string",
        "required": false,
        "default": "ahoy-dtu",
        "description": "Base MQTT topic for AHOY-DTU messages"
      },
      "connectionType": {
        "title": "Connection Type",
        "type": "string",
        "required": false,
        "default": "platform",
        "enum": [
          "platform",
          "child-bridge"
        ],
        "enumNames": [
          "🏠 Platform Plugin (Main Homebridge)",
          "🔌 Child Bridge (Separate Process)"
        ],
        "description": "Choose between platform plugin or child bridge mode"
      },
      "usePreset": {
        "title": "Preset Configuration",
        "type": "string",
        "required": false,
        "enum": [
          "basic",
          "detailed",
          "individual-inverters"
        ],
        "enumNames": [
          "📊 Basic (Power, Energy, Status)",
          "🔍 Detailed (All Available Data)",
          "🏭 Individual Inverters"
        ],
        "description": "Choose a preset configuration for your solar system"
      },
      "selectedDevices": {
        "title": "Selected Devices",
        "type": "array",
        "items": {
          "type": "string"
        },
        "required": false,
        "description": "Specific MQTT topics to monitor (leave empty to use preset)"
      },
      "discoverDevices": {
        "title": "Auto-Discover Devices",
        "type": "boolean",
        "required": false,
        "default": false,
        "description": "Automatically discover available devices from MQTT topics"
      },
      "usePowerOutlets": {
        "title": "Use Power Outlets",
        "type": "boolean",
        "required": false,
        "default": true,
        "description": "Use Outlet service for power measurements (shows actual Watts instead of lumens)"
      },
      "maxEnergyPerDay": {
        "title": "Maximum Daily Energy",
        "type": "number",
        "required": false,
        "default": 10,
        "minimum": 0,
        "maximum": 1000,
        "description": "Maximum daily energy production in kWh (for percentage calculations)"
      },
      "offlineThresholdMinutes": {
        "title": "Offline Threshold",
        "type": "integer",
        "required": false,
        "default": 15,
        "minimum": 1,
        "maximum": 1440,
        "description": "Minutes before considering device offline"
      },
      "dailyReports": {
        "title": "Daily Reports",
        "type": "object",
        "properties": {
          "enabled": {
            "title": "Enable Daily Reports",
            "type": "boolean",
            "required": false,
            "default": true,
            "description": "Enable daily solar production reports"
          },
          "language": {
            "title": "Report Language",
            "type": "string",
            "required": false,
            "default": "de",
            "enum": [
              "de",
              "en",
              "fr",
              "it",
              "zh"
            ],
            "enumNames": [
              "🇩🇪 Deutsch",
              "🇺🇸 English",
              "🇫🇷 Français",
              "🇮🇹 Italiano",
              "🇨🇳 中文"
            ],
            "description": "Language for daily report notifications"
          },
          "time": {
            "title": "Report Time",
            "type": "string",
            "required": false,
            "default": "20:00",
            "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$",
            "description": "Time for daily reports (24-hour format, e.g., 20:00)"
          },
          "includePowerStats": {
            "title": "Include Power Statistics",
            "type": "boolean",
            "required": false,
            "default": true,
            "description": "Include peak power and average power in daily reports"
          },
          "includeEnergyStats": {
            "title": "Include Energy Statistics",
            "type": "boolean",
            "required": false,
            "default": true,
            "description": "Include daily energy and efficiency in daily reports"
          }
        }
      },
      "energyProvider": {
        "title": "Energy Provider Service",
        "type": "object",
        "properties": {
          "enabled": {
            "title": "Enable Energy Provider",
            "type": "boolean",
            "required": false,
            "default": true,
            "description": "Enable Apple Home Energy Provider service (iOS 16+)"
          },
          "fallbackToStandard": {
            "title": "Fallback to Standard Services",
            "type": "boolean",
            "required": false,
            "default": true,
            "description": "Use standard HomeKit services if Energy Provider not available"
          }
        }
      },
      "advanced": {
        "title": "Advanced Settings",
        "type": "object",
        "properties": {
          "debugMode": {
            "title": "Debug Mode",
            "type": "boolean",
            "required": false,
            "default": false,
            "description": "Enable detailed debug logging"
          },
          "cacheTimeout": {
            "title": "Cache Timeout",
            "type": "integer",
            "required": false,
            "default": 300,
            "minimum": 60,
            "maximum": 3600,
            "description": "Cache timeout in seconds"
          },
          "autoRestart": {
            "title": "Auto Restart",
            "type": "boolean",
            "required": false,
            "default": true,
            "description": "Automatically restart plugin on connection issues"
          }
        }
      }
    }
  },
  "ui": true,
  "uiSchema": {
    "ui:order": [
      "name",
      "uiLanguage",
      "connectionType",
      "mqttHost",
      "mqttPort",
      "mqttUsername",
      "mqttPassword",
      "mqttTopic",
      "usePreset",
      "selectedDevices",
      "discoverDevices",
      "usePowerOutlets",
      "maxEnergyPerDay",
      "offlineThresholdMinutes",
      "dailyReports",
      "energyProvider",
      "advanced"
    ],
    "dailyReports": {
      "ui:order": [
        "enabled",
        "language",
        "time",
        "includePowerStats",
        "includeEnergyStats"
      ]
    },
    "energyProvider": {
      "ui:order": [
        "enabled",
        "fallbackToStandard"
      ]
    },
    "advanced": {
      "ui:order": [
        "debugMode",
        "cacheTimeout",
        "autoRestart"
      ]
    }
  }
}
